<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="prev" title="Timer" href="generated/delu.tools.Timer.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 7.1.2 and Furo 2023.09.10 -->
        <title>[deprecated] - DeLU</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2f8d3599" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-title-font-size: 90.5%;
  --admonition-font-size: 90.5%;
  --code-font-size: var(--font-size--small);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">DeLU</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../version.html">v0.0.19 ▼</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Yura52/delu">Source code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API &amp; Examples</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="delu.html">delu</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of delu</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.to.html">to</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.cat.html">cat</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.iter_batches.html">iter_batches</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cuda.html">delu.cuda</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of delu.cuda</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.cuda.free_memory.html">free_memory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="nn.html">delu.nn</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of delu.nn</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.nn.Lambda.html">Lambda</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.nn.NLinear.html">NLinear</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.nn.named_sequential.html">named_sequential</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="random.html">delu.random</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of delu.random</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.random.seed.html">seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.random.get_state.html">get_state</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.random.set_state.html">set_state</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.random.preserve_state.html">preserve_state</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="utils.data.html">delu.utils.data</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of delu.utils.data</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.utils.data.Enumerate.html">Enumerate</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.utils.data.IndexDataset.html">IndexDataset</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tools.html"><strong>delu.tools</strong></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of delu.tools</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.tools.EarlyStopping.html">EarlyStopping</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/delu.tools.Timer.html">Timer</a></li>
</ul>
</li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">[deprecated]</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/Yura52/delu/edit/main/docs/api/deprecated.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="deprecated">
<h1>[deprecated]<a class="headerlink" href="#deprecated" title="Permalink to this heading">#</a></h1>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use the right sidebar, the search widget or <code class="xref py py-obj docutils literal notranslate"><span class="pre">Ctrl+F</span></code> to find the items you need.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="delu.EarlyStopping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">EarlyStopping</span></span><a class="reference internal" href="../_modules/delu/_tools.html#EarlyStopping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.EarlyStopping" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="generated/delu.tools.EarlyStopping.html#delu.tools.EarlyStopping" title="delu.tools.EarlyStopping"><code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStopping</span></code></a></p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Renamed to <a class="reference internal" href="generated/delu.tools.EarlyStopping.html#delu.tools.EarlyStopping" title="delu.tools.EarlyStopping"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.tools.EarlyStopping</span></code></a>)</p>
<dl class="py method">
<dt class="sig sig-object py" id="delu.EarlyStopping.forget_bad_updates">
<span class="sig-name descname"><span class="pre">forget_bad_updates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_tools.html#EarlyStopping.forget_bad_updates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.EarlyStopping.forget_bad_updates" title="Permalink to this definition">#</a></dt>
<dd><p>In the new class, see <a class="reference internal" href="generated/delu.tools.EarlyStopping.html#delu.tools.EarlyStopping.reset_unsuccessful_updates" title="delu.tools.EarlyStopping.reset_unsuccessful_updates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.tools.EarlyStopping.reset_unsuccessful_updates</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.Timer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">Timer</span></span><a class="reference internal" href="../_modules/delu/_tools.html#Timer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Timer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="generated/delu.tools.Timer.html#delu.tools.Timer" title="delu.tools.Timer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timer</span></code></a></p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Renamed to <a class="reference internal" href="generated/delu.tools.Timer.html#delu.tools.Timer" title="delu.tools.Timer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.tools.Timer</span></code></a>)</p>
<dl class="py method">
<dt class="sig sig-object py" id="delu.Timer.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/delu/_tools.html#Timer.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Timer.__call__" title="Permalink to this definition">#</a></dt>
<dd><p>In the new class, see <a class="reference internal" href="generated/delu.tools.Timer.html#delu.tools.Timer.elapsed" title="delu.tools.Timer.elapsed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.tools.Timer.elapsed</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Timer.format">
<span class="sig-name descname"><span class="pre">format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">format_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/delu/_tools.html#Timer.format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Timer.format" title="Permalink to this definition">#</a></dt>
<dd><p>In the new class, see the tutorial in <a class="reference internal" href="generated/delu.tools.Timer.html#delu.tools.Timer" title="delu.tools.Timer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.tools.Timer</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.ProgressTracker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">ProgressTracker</span></span><a class="reference internal" href="../_modules/delu/_tools.html#ProgressTracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.ProgressTracker" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Helps with early stopping and tracks the best metric value.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference internal" href="#delu.EarlyStopping" title="delu.EarlyStopping"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.EarlyStopping</span></code></a> and manually track the best score.)</p>
<p>For <a class="reference internal" href="#delu.ProgressTracker" title="delu.ProgressTracker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ProgressTracker</span></code></a>, <strong>the greater score is the better score</strong>.
At any moment the tracker is in one of the following states:</p>
<ul class="simple">
<li><p><em>success</em>: the last update increased the best score</p></li>
<li><p><em>fail</em>: last <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">patience</span></code> updates did not improve the best score</p></li>
<li><p><em>neutral</em>: if neither success nor fail</p></li>
</ul>
<p class="rubric">Tutorial</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">progress</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">ProgressTracker</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">-</span><span class="mi">999999999</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">success</span>  <span class="c1"># the first update always updates the best score</span>

<span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">success</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">best_score</span> <span class="o">==</span> <span class="mi">123</span>

<span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">success</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">fail</span>

<span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">success</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">fail</span>
<span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="c1"># patience is 2 and the best score is not updated for more than 2 steps</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">fail</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">best_score</span> <span class="o">==</span> <span class="mi">123</span>  <span class="c1"># fail doesn&#39;t affect the best score</span>
<span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">fail</span>  <span class="c1"># still no improvements</span>

<span class="n">progress</span><span class="o">.</span><span class="n">forget_bad_updates</span><span class="p">()</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">fail</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">success</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">best_score</span> <span class="o">==</span> <span class="mi">123</span>
<span class="n">progress</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">fail</span>  <span class="c1"># just 1 bad update (the patience is 2)</span>

<span class="n">progress</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">fail</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">progress</span><span class="o">.</span><span class="n">success</span>
<span class="k">assert</span> <span class="n">progress</span><span class="o">.</span><span class="n">best_score</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="delu.ProgressTracker.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_tools.html#ProgressTracker.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.ProgressTracker.__init__" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patience</strong> – Allowed number of unsuccessfull updates. For example, if patience
is 2, then 2 unsuccessfull updates in a row is not a fail,
but 3 unsuccessfull updates in a row is a fail.
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> means “infinite patience” and the progress tracker is never
in the “fail” state.</p></li>
<li><p><strong>min_delta</strong> – the minimal improvement over the current best score
to count it as success.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">progress</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">ProgressTracker</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">progress</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">ProgressTracker</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="delu.ProgressTracker.best_score">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></em><a class="headerlink" href="#delu.ProgressTracker.best_score" title="Permalink to this definition">#</a></dt>
<dd><p>The best score so far.</p>
<p>If the tracker is just created/reset, return <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="delu.ProgressTracker.fail">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fail</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><a class="headerlink" href="#delu.ProgressTracker.fail" title="Permalink to this definition">#</a></dt>
<dd><p>Check if the tracker is in the “fail” state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.ProgressTracker.forget_bad_updates">
<span class="sig-name descname"><span class="pre">forget_bad_updates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_tools.html#ProgressTracker.forget_bad_updates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.ProgressTracker.forget_bad_updates" title="Permalink to this definition">#</a></dt>
<dd><p>Reset unsuccessfull update counter and set the status to “neutral”.</p>
<p>Note that this method does NOT reset the best score.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.ProgressTracker.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_tools.html#ProgressTracker.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.ProgressTracker.reset" title="Permalink to this definition">#</a></dt>
<dd><p>Reset everything.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="delu.ProgressTracker.success">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">success</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></em><a class="headerlink" href="#delu.ProgressTracker.success" title="Permalink to this definition">#</a></dt>
<dd><p>Check if the tracker is in the “success” state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.ProgressTracker.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_tools.html#ProgressTracker.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.ProgressTracker.update" title="Permalink to this definition">#</a></dt>
<dd><p>Submit a new score and update the tracker’s state accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>score</strong> – the score to use for the update.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.Stream">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">Stream</span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Smart wrapper for data loaders and iterables.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️</p>
<p><a class="reference internal" href="#delu.Stream" title="delu.Stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream</span></code></a> simplifies managing loops, especially in typical Deep Learning scenarios.
<a class="reference internal" href="#delu.Stream" title="delu.Stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream</span></code></a>:</p>
<ul class="simple">
<li><p>manages the “epoch” and “iteration” variables</p></li>
<li><p>allows to dump and restore loop’s state: epoch, iteration, etc.</p></li>
<li><p>allows to customize the size of epoch</p></li>
<li><p>allows to change the underlying data loader on the fly</p></li>
<li><p>enables useful patterns</p></li>
</ul>
<p class="rubric">Tutorial</p>
<p>Let’s start with the most common training loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_epoch</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
        <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Epoch:&#39;</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="s1">&#39;Iteration:&#39;</span><span class="p">,</span> <span class="n">iteration</span><span class="p">)</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Let’s enhance the loop using <a class="reference internal" href="#delu.Stream" title="delu.Stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">DataLoader</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>  <span class="c1"># (A)</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">epochs</span><span class="p">(</span><span class="n">max_epoch</span><span class="p">):</span>  <span class="c1"># (B)</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>  <span class="c1"># (C)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Epoch:&#39;</span><span class="p">,</span> <span class="n">stream</span><span class="o">.</span><span class="n">epoch</span><span class="p">,</span> <span class="s1">&#39;Iteration:&#39;</span><span class="p">,</span> <span class="n">stream</span><span class="o">.</span><span class="n">iteration</span><span class="p">)</span>  <span class="c1"># (D)</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Some comments for the above code:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">(A)</span></code> <a class="reference internal" href="#delu.Stream" title="delu.Stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream</span></code></a> is created by passing a dataloader as a single argument (in fact, you can pass any iterable object);
the dataloader is accessible via <a class="reference internal" href="#delu.Stream.loader" title="delu.Stream.loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.loader</span></code></a></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">(B)</span></code> <code class="code docutils literal notranslate"><span class="pre">epoch</span></code> is an iterator over batches for one epoch</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">(C)</span></code> a progress bar for batches is displayed (for the whole training loop, not just for one epoch)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">(D)</span></code> <a class="reference internal" href="#delu.Stream.epoch" title="delu.Stream.epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.epoch</span></code></a> and <a class="reference internal" href="#delu.Stream.iteration" title="delu.Stream.iteration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.iteration</span></code></a> are managed automatically</p></li>
</ul>
<p>Saving the loop’s state and resuming the loop is possible with the methods
<a class="reference internal" href="#delu.Stream.state_dict" title="delu.Stream.state_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.state_dict</span></code></a>, <a class="reference internal" href="#delu.Stream.load_state_dict" title="delu.Stream.load_state_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.load_state_dict</span></code></a>. In practice, it can look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">DataLoader</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>
<span class="k">if</span> <span class="n">load_from_checkpoint</span><span class="p">:</span>
    <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">])</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">])</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;stream&#39;</span><span class="p">])</span>
<span class="o">...</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">epochs</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>
        <span class="o">...</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="s1">&#39;optimizer&#39;</span><span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="s1">&#39;stream&#39;</span><span class="p">:</span> <span class="n">stream</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
        <span class="p">},</span>
        <span class="sa">f</span><span class="s1">&#39;checkpoint_</span><span class="si">{</span><span class="n">stream</span><span class="o">.</span><span class="n">epoch</span><span class="si">}</span><span class="s1">.pt&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stream’s state does not include the loader’s state. See <a class="reference internal" href="#delu.Stream.state_dict" title="delu.Stream.state_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.state_dict</span></code></a> and
<a class="reference internal" href="#delu.Stream.load_state_dict" title="delu.Stream.load_state_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.load_state_dict</span></code></a> for details.</p>
</div>
<p>In order to customize the epoch size, pass the size as the second argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">epochs</span><span class="p">(</span><span class="n">max_epoch</span><span class="p">,</span> <span class="n">custom_epoch_size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Changing the underlying loader on the fly is possible at <em>any</em> moment (even in the
middle of epoch) via <a class="reference internal" href="#delu.Stream.set_loader" title="delu.Stream.set_loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.set_loader</span></code></a>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">epochs</span><span class="p">(</span><span class="n">max_epoch</span><span class="p">,</span> <span class="n">custom_epoch_size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>
        <span class="o">...</span>
        <span class="k">if</span> <span class="n">need_new_data</span><span class="p">():</span>
            <span class="n">stream</span><span class="o">.</span><span class="n">set_loader</span><span class="p">(</span><span class="n">new_loader</span><span class="p">)</span>
</pre></div>
</div>
<p>If the method <a class="reference internal" href="#delu.Stream.epochs" title="delu.Stream.epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.epochs</span></code></a> does not fit your workflow and you want more control
over the loop, there are more “low-level” methods (in fact, <a class="reference internal" href="#delu.Stream.epochs" title="delu.Stream.epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.epochs</span></code></a> is just
a thin wrapper around them):</p>
<ul class="simple">
<li><p><a class="reference internal" href="#delu.Stream.increment_epoch" title="delu.Stream.increment_epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.increment_epoch</span></code></a></p></li>
<li><p><a class="reference internal" href="#delu.Stream.data" title="delu.Stream.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.data</span></code></a></p></li>
<li><p><a class="reference internal" href="#delu.Stream.next" title="delu.Stream.next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.next</span></code></a></p></li>
</ul>
<p>For example, the most common training loop can be implemented as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># A</span>
<span class="k">while</span> <span class="n">stream</span><span class="o">.</span><span class="n">epoch</span> <span class="o">&lt;</span> <span class="n">max_epoch</span><span class="p">:</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">increment_epoch</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">():</span>
        <span class="o">...</span>

<span class="c1"># B</span>
<span class="k">while</span> <span class="n">stream</span><span class="o">.</span><span class="n">epoch</span> <span class="o">&lt;</span> <span class="n">max_epoch</span><span class="p">:</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">increment_epoch</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">loader</span><span class="p">)):</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>  <span class="c1"># stream.iteration is incremented automatically</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>The “infinite” stream of data can be implemented as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)):</span>
    <span class="o">...</span>
    <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>  <span class="c1"># for example: `if stream.iteration % frequency == 0`</span>
        <span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For better technical understanding, keep in mind that <a class="reference internal" href="#delu.Stream" title="delu.Stream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream</span></code></a> simply
encapsulates an “infinite iterator” that is constantly moving forward. The
behavior is absolutely the same for both finite and infinite iterables and can
be expressed with the following loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>  <span class="c1"># the loader which is passed to the constructor</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Documentation for <a class="reference internal" href="#delu.Stream.next" title="delu.Stream.next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.next</span></code></a> and <a class="reference internal" href="#delu.Stream.data" title="delu.Stream.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.data</span></code></a> provide helpful examples.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.__init__" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loader</strong> – any kind of iterable (DataLoader, list, iterator, generator, …)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.12)"><span class="pre">Iterator</span></a></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.data" title="Permalink to this definition">#</a></dt>
<dd><p>Iterate over the loader.</p>
<p>Under the hood, <a class="reference internal" href="#delu.Stream.next" title="delu.Stream.next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.next</span></code></a> is called, hence, <a class="reference internal" href="#delu.Stream.iteration" title="delu.Stream.iteration"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.iteration</span></code></a> changes
during iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_items</strong> – how many items to produce. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, interpreted as
<code class="code docutils literal notranslate"><span class="pre">len(self.loader)</span></code>. If <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>, must be <code class="code docutils literal notranslate"><span class="pre">float('inf')</span></code> or
<a class="reference external" href="https://docs.python.org/3/library/math.html#math.inf" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">math.inf</span></code></a>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">())</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="c1"># stream doesn&#39;t &quot;start over&quot;!</span>
<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)):</span>
    <span class="o">...</span>
    <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">iteration</span> <span class="o">%</span> <span class="n">frequency</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="delu.Stream.epoch">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">epoch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#delu.Stream.epoch" title="Permalink to this definition">#</a></dt>
<dd><p>Current epoch.</p>
<p>Technically, the number of <a class="reference internal" href="#delu.Stream.increment_epoch" title="delu.Stream.increment_epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.increment_epoch</span></code></a> calls.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">max_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">epoch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">progress_bar_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.12)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterator" title="(in Python v3.12)"><span class="pre">Iterator</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.epochs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.epochs" title="Permalink to this definition">#</a></dt>
<dd><p>Iterate over data epochs.</p>
<p>A shortcut for what is probably the most popular form of a training loop in Deep
Learning (plus a progress bar):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">epochs</span><span class="p">(</span><span class="n">max_epoch</span><span class="p">,</span> <span class="n">epoch_size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>
        <span class="o">...</span>

<span class="c1"># is equivalent to:</span>

<span class="k">while</span> <span class="n">stream</span><span class="o">.</span><span class="n">epoch</span> <span class="o">&lt;</span> <span class="n">max_epoch</span><span class="p">:</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">increment_epoch</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">epoch_size</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_epoch</strong> – defines the number of epochs. The loop keeps running while
<code class="code docutils literal notranslate"><span class="pre">self.epoch</span> <span class="pre">&lt;</span> <span class="pre">max_epoch</span></code>. If <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>, must be <code class="code docutils literal notranslate"><span class="pre">float('inf')</span></code>
or <a class="reference external" href="https://docs.python.org/3/library/math.html#math.inf" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">math.inf</span></code></a>.</p></li>
<li><p><strong>epoch_size</strong> – the number of data items in one epoch
(is forwarded to <a class="reference internal" href="#delu.Stream.data" title="delu.Stream.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.data</span></code></a>).</p></li>
<li><p><strong>progress_bar_config</strong> – if not <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> (the default value is <code class="code docutils literal notranslate"><span class="pre">{}</span></code>!), a
progress bar for iterations will be displayed and the argument will be
interpreted as key-word arguments for
<a class="reference external" href="https://tqdm.github.io/docs/tqdm/#__init__">tqdm</a>. The following
key-word arguments will be automatically added if not presented in
<code class="code docutils literal notranslate"><span class="pre">progress_bar_config</span></code>: <code class="code docutils literal notranslate"><span class="pre">initial</span></code>, <code class="code docutils literal notranslate"><span class="pre">total</span></code> (if can be
inferred from the arguments and/or from <a class="reference internal" href="#delu.Stream.loader" title="delu.Stream.loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.loader</span></code></a>). If
[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ipywidgets</span></code>](<a class="reference external" href="https://ipywidgets.readthedocs.io">https://ipywidgets.readthedocs.io</a>) is installed and the
program is running in JupyterLab (Jupyter Notebook), then the pretty
widget is used instead of the text-based one.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Iterator over iterators over data from <a class="reference internal" href="#delu.Stream.loader" title="delu.Stream.loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.loader</span></code></a>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">epochs</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0
1
2
-
0
1
2
-
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">epochs</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">epoch</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0
1
-
2
0
-
1
2
-
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.increment_epoch">
<span class="sig-name descname"><span class="pre">increment_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.increment_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.increment_epoch" title="Permalink to this definition">#</a></dt>
<dd><p>Increment <a class="reference internal" href="#delu.Stream.epoch" title="delu.Stream.epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.epoch</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">epoch</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">stream</span><span class="o">.</span><span class="n">increment_epoch</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">epoch</span> <span class="o">==</span> <span class="mi">1</span>
<span class="n">stream</span><span class="o">.</span><span class="n">increment_epoch</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">epoch</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="delu.Stream.iteration">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iteration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#delu.Stream.iteration" title="Permalink to this definition">#</a></dt>
<dd><p>Current iteration.</p>
<p>Technically, the number of <a class="reference internal" href="#delu.Stream.next" title="delu.Stream.next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.next</span></code></a> calls.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.load_state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.load_state_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Load state dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_dict</strong> – state. Must be produced by <a class="reference internal" href="#delu.Stream.state_dict" title="delu.Stream.state_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.state_dict</span></code></a>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method does not affect data that is produced by <a class="reference internal" href="#delu.Stream.epochs" title="delu.Stream.epochs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.epochs</span></code></a>,
<a class="reference internal" href="#delu.Stream.data" title="delu.Stream.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.data</span></code></a>, <a class="reference internal" href="#delu.Stream.next" title="delu.Stream.next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.next</span></code></a> (see the examples below), i.e. the method
only sets some “metadata” such as epoch, iteration etc. If you want to
load the “state of data stream”, you have to load the state of corresponding
random number generators separately.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">stream</span><span class="o">.</span><span class="n">increment_epoch</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;epoch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;iteration&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">new_stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">new_stream</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">new_stream</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;epoch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;iteration&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="k">assert</span> <span class="n">new_stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">new_stream</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;epoch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;iteration&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="delu.Stream.loader">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loader</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a></em><a class="headerlink" href="#delu.Stream.loader" title="Permalink to this definition">#</a></dt>
<dd><p>The underlying loader.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.next">
<span class="sig-name descname"><span class="pre">next</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.next"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.next" title="Permalink to this definition">#</a></dt>
<dd><p>Get the next item and increment iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The next item.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">iteration</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">iteration</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">iteration</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
    <span class="o">...</span>
    <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">iteration</span> <span class="o">%</span> <span class="n">frequency</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.reload_iterator">
<span class="sig-name descname"><span class="pre">reload_iterator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.reload_iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.reload_iterator" title="Permalink to this definition">#</a></dt>
<dd><p>Set the underlying iterator to <code class="xref py py-obj docutils literal notranslate"><span class="pre">iter(self.loader)</span></code>.</p>
<p>If the underlying loader is a finite iterable, the method can be used to
interrupt and skip the current epoch (i.e. skip its data). If the loader is an
iterator, the method does nothing.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="n">stream</span><span class="o">.</span><span class="n">reload_iterator</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>

<span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="n">stream</span><span class="o">.</span><span class="n">reload_iterator</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.set_loader">
<span class="sig-name descname"><span class="pre">set_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.set_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.set_loader" title="Permalink to this definition">#</a></dt>
<dd><p>Set new loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loader</strong> – </p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">repeat</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">iteration</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">set_loader</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1 0
2 0
3 1
4 1
5 1
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.Stream.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/delu/_stream.html#Stream.state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.Stream.state_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Get the stream’s state.</p>
<p>The result can be passed to <a class="reference internal" href="#delu.Stream.load_state_dict" title="delu.Stream.load_state_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Stream.load_state_dict</span></code></a>. The result includes:</p>
<ul class="simple">
<li><p>epoch</p></li>
<li><p>iteration</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Fields related to data (loader, iterator etc.) are <strong>NOT</strong> included in the
state. If you want to save the “state of data stream” then you have to save
the state of corresponding random number generators separately.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>state</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;epoch&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;iteration&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">stream</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">stream</span><span class="o">.</span><span class="n">increment_epoch</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">stream</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;epoch&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;iteration&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delu.collate">
<span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">collate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></span><a class="reference internal" href="../_modules/delu/data.html#collate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.collate" title="Permalink to this definition">#</a></dt>
<dd><p>Almost an alias for <code class="code docutils literal notranslate"><span class="pre">torch.utils.data.dataloader.default_collate</span></code>.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.default_collate" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.default_collate</span></code></a>)</p>
<p>Namely, the input is allowed to be any kind of iterable, not only a list. Firstly,
if it is not a list, it is transformed to a list. Then, the list is passed to the
original function and the result is returned as is.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delu.concat">
<span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/delu/_tensor_ops.html#concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.concat" title="Permalink to this definition">#</a></dt>
<dd><p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference internal" href="generated/delu.cat.html#delu.cat" title="delu.cat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.cat</span></code></a>.)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delu.improve_reproducibility">
<span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">improve_reproducibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_cuda_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/delu/_utilities.html#improve_reproducibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.improve_reproducibility" title="Permalink to this definition">#</a></dt>
<dd><p>Set seeds and turn off non-deterministic algorithms.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference internal" href="generated/delu.random.seed.html#delu.random.seed" title="delu.random.seed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.random.seed</span></code></a> and manually set flags mentioned in the <a class="reference external" href="https://pytorch.org/docs/stable/notes/randomness.html">PyTorch docs on reproducibility</a>)</p>
<p>Do everything possible to improve reproducibility for code that relies on global
random number generators. See also the note below.</p>
<p>Sets:</p>
<ol class="arabic simple">
<li><p>seeds in <a class="reference internal" href="random.html#module-delu.random" title="delu.random"><code class="xref py py-obj docutils literal notranslate"><span class="pre">random</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/index.html#module-numpy.random" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/stable/torch.html#module-torch" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/stable/cuda.html#module-torch.cuda" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.cuda</span></code></a></p></li>
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/backends.html#torch.backends.cudnn.benchmark" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.backends.cudnn.benchmark</span></code></a> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a></p></li>
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/backends.html#torch.backends.cudnn.deterministic" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.backends.cudnn.deterministic</span></code></a> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a></p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_seed</strong> – the argument for <a class="reference internal" href="generated/delu.random.seed.html#delu.random.seed" title="delu.random.seed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.random.seed</span></code></a>. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, a high-quality base
seed is generated instead.</p></li>
<li><p><strong>one_cuda_seed</strong> – the argument for <a class="reference internal" href="generated/delu.random.seed.html#delu.random.seed" title="delu.random.seed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.random.seed</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>if <code class="docutils literal notranslate"><span class="pre">base_seed</span></code> is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, the generated base seed is</dt><dd><p>returned; otherwise, <code class="docutils literal notranslate"><span class="pre">base_seed</span></code> is returned as is</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>base_seed</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t want to choose the base seed, but still want to have a chance to
reproduce things, you can use the following pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Seed:&#39;</span><span class="p">,</span> <span class="n">delu</span><span class="o">.</span><span class="n">improve_reproducibility</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>100% reproducibility is not always possible in PyTorch. See
<a class="reference external" href="https://pytorch.org/docs/stable/notes/randomness.html">this page</a> for
details.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">delu</span><span class="o">.</span><span class="n">improve_reproducibility</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">seed</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">improve_reproducibility</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.evaluation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.</span></span><span class="sig-name descname"><span class="pre">evaluation</span></span><a class="reference internal" href="../_modules/delu/_utilities.html#evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.evaluation" title="Permalink to this definition">#</a></dt>
<dd><p>Context-manager &amp; decorator for models evaluation.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <code class="docutils literal notranslate"><span class="pre">model.eval()</span></code> + <code class="docutils literal notranslate"><span class="pre">torch.no_inference/no_grad</span></code>)</p>
<p>This code…</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">delu</span><span class="o">.</span><span class="n">evaluation</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>  <span class="c1"># or: evaluation(model_0, model_1, ...)</span>
    <span class="o">...</span>
<span class="nd">@delu</span><span class="o">.</span><span class="n">evaluation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>  <span class="c1"># or: @evaluation(model_0, model_1, ...)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>…is equivalent to the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">context</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">torch</span><span class="p">,</span> <span class="s1">&#39;inference_mode&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">)</span>
<span class="k">with</span> <span class="n">context</span><span class="p">():</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="o">...</span>
<span class="nd">@context</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="o">...</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>modules</strong> – </p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The training status of modules is undefined once a context is finished or a
decorated function returns.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The function must be used in the same way as <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.no_grad.html#torch.no_grad" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.no_grad</span></code></a> and
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.inference_mode.html#torch.inference_mode" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.inference_mode</span></code></a>, i.e. only as a context manager or a decorator as shown
below in the examples. Otherwise, the behaviour is undefined.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Contrary to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.no_grad.html#torch.no_grad" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.no_grad</span></code></a> and <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.inference_mode.html#torch.inference_mode" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.inference_mode</span></code></a>, the function cannot be
used to decorate generators. So, in the case of generators, you have to manually
create a context:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_generator</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">delu</span><span class="o">.</span><span class="n">evaluation</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">with</span> <span class="n">delu</span><span class="o">.</span><span class="n">evaluation</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="n">delu</span><span class="o">.</span><span class="n">evaluation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="o">...</span>
<span class="nd">@delu</span><span class="o">.</span><span class="n">evaluation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="o">...</span>
<span class="nd">@delu</span><span class="o">.</span><span class="n">evaluation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.data.Enumerate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.data.</span></span><span class="sig-name descname"><span class="pre">Enumerate</span></span><a class="reference internal" href="../_modules/delu/data.html#Enumerate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.Enumerate" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="generated/delu.utils.data.Enumerate.html#delu.utils.data.Enumerate" title="delu.utils.data.Enumerate"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enumerate</span></code></a></p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Renamed to <a class="reference internal" href="generated/delu.utils.data.Enumerate.html#delu.utils.data.Enumerate" title="delu.utils.data.Enumerate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.utils.data.Enumerate</span></code></a>)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.data.IndexDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.data.</span></span><span class="sig-name descname"><span class="pre">IndexDataset</span></span><a class="reference internal" href="../_modules/delu/data.html#IndexDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.IndexDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="generated/delu.utils.data.IndexDataset.html#delu.utils.data.IndexDataset" title="delu.utils.data.IndexDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexDataset</span></code></a></p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference internal" href="generated/delu.utils.data.IndexDataset.html#delu.utils.data.IndexDataset" title="delu.utils.data.IndexDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.utils.data.IndexDataset</span></code></a>)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.data.FnDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.data.</span></span><span class="sig-name descname"><span class="pre">FnDataset</span></span><a class="reference internal" href="../_modules/delu/data.html#FnDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.FnDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>Create simple PyTorch datasets without classes and inheritance.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️</p>
<p><a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a> allows avoiding implementing <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Dataset</span></code></a> classes in
simple cases.</p>
<p class="rubric">Tutorial</p>
<p>First, a quick example. Without <a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="k">class</span> <span class="nc">ImagesList</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">transform</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="o">=</span> <span class="n">filenames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">ImagesList</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
</pre></div>
</div>
<p>With <a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
<span class="c1"># Cache images after the first load:</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">lru_cache</span><span class="p">(</span><span class="kc">None</span><span class="p">)(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">),</span> <span class="n">filenames</span><span class="p">)</span>
</pre></div>
</div>
<p>In other words, with the vanilla PyTorch, in order to create a dataset,
you have to inherit from <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code></a> and implement three methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__len__</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code></p></li>
</ul>
<p>With <a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a> the only thing you <em>may</em> need to implement is the <code class="docutils literal notranslate"><span class="pre">fn</span></code>
argument that will power <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>. The easiest way to learn
<a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a> is to go through the examples below.</p>
<p>A list of images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)</span>
<span class="c1"># dataset[i] returns Image.open(filenames[i])</span>
</pre></div>
</div>
<p>A list of images that are cached after the first load:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">lru_cache</span><span class="p">(</span><span class="kc">None</span><span class="p">)(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">),</span> <span class="n">filenames</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a> is handy for creating datasets that read from files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">images_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="n">images_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>
</pre></div>
</div>
<p>If you only need files with specific extensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="n">images_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.png&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>If you only need files with specific extensions located in all subfolders:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span>
    <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">images_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;**/*.png&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">condition</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p>A segmentation dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image_filenames</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">gt_filenames</span> <span class="o">=</span> <span class="o">...</span>

<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_filenames</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">gt_filenames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">get</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">image_filenames</span><span class="p">))</span>
</pre></div>
</div>
<p>A dummy dataset that demonstrates that <a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a> is a very general thing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">10</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="c1"># dataset[i] returns g(f(i))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
<span class="k">assert</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">20</span>
<span class="k">assert</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">40</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="delu.data.FnDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></span><a class="reference internal" href="../_modules/delu/data.html#FnDataset.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.FnDataset.__getitem__" title="Permalink to this definition">#</a></dt>
<dd><p>Get value by index.</p>
<p>See <a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.data.FnDataset.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/data.html#FnDataset.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.FnDataset.__init__" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> – the function that produces values based on arguments from <code class="docutils literal notranslate"><span class="pre">args</span></code></p></li>
<li><p><strong>args</strong> – arguments for <code class="docutils literal notranslate"><span class="pre">fn</span></code>. If an iterable, but not a list, then is
casted to a list. If an integer, then the behavior is the same as for
<code class="docutils literal notranslate"><span class="pre">list(range(args))</span></code>. The size of <code class="docutils literal notranslate"><span class="pre">args</span></code> defines the return
value for <a class="reference internal" href="#delu.data.FnDataset.__len__" title="delu.data.FnDataset.__len__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset.__len__</span></code></a>.</p></li>
<li><p><strong>transform</strong> – if presented, is applied to the return value of <code class="xref py py-obj docutils literal notranslate"><span class="pre">fn</span></code> in
<a class="reference internal" href="#delu.data.FnDataset.__getitem__" title="delu.data.FnDataset.__getitem__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset.__getitem__</span></code></a></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PIL.Image</span> <span class="k">as</span> <span class="nn">Image</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">T</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">FnDataset</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.data.FnDataset.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/delu/data.html#FnDataset.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.FnDataset.__len__" title="Permalink to this definition">#</a></dt>
<dd><p>Get the dataset size.</p>
<p>See <a class="reference internal" href="#delu.data.FnDataset" title="delu.data.FnDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FnDataset</span></code></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>size</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="delu.data.IndexLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">delu.data.</span></span><span class="sig-name descname"><span class="pre">IndexLoader</span></span><a class="reference internal" href="../_modules/delu/data.html#IndexLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.IndexLoader" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Like <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataLoader</span></code></a>, but over indices instead of data.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference internal" href="#delu.data.IndexDataset" title="delu.data.IndexDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.data.IndexDataset</span></code></a> and <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataLoader</span></code></a>)</p>
<p><strong>The shuffling logic is delegated to the native PyTorch DataLoader</strong>, i.e. no
custom logic is performed under the hood. The data loader which actually generates
indices is available as <a class="reference internal" href="#delu.data.IndexLoader.loader" title="delu.data.IndexLoader.loader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IndexLoader.loader</span></code></a>.</p>
<p class="rubric">Examples</p>
<p>Usage for training:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">IndexLoader</span><span class="p">(</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">batch_idx</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Other examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># len(dataset)</span>
<span class="k">for</span> <span class="n">batch_idx</span> <span class="ow">in</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">IndexLoader</span><span class="p">(</span><span class="n">dataset_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch_idx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tensor([0, 1, 2])
tensor([3, 4, 5])
tensor([6, 7, 8])
tensor([9])
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># len(dataset)</span>
<span class="k">for</span> <span class="n">batch_idx</span> <span class="ow">in</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">IndexLoader</span><span class="p">(</span><span class="n">dataset_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch_idx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tensor([0, 1, 2])
tensor([3, 4, 5])
tensor([6, 7, 8])
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="delu.data.IndexLoader.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.1)"><span class="pre">device</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/data.html#IndexLoader.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.IndexLoader.__init__" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> – the number of items (for example, <code class="code docutils literal notranslate"><span class="pre">len(dataset)</span></code>)</p></li>
<li><p><strong>args</strong> – positional arguments for <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a></p></li>
<li><p><strong>device</strong> – if not CPU, then all indices are materialized and moved to the
device at the beginning of every loop. It can be useful when the indices
are applied to non-CPU data (e.g. CUDA-tensors) and moving data between
devices takes non-negligible time (which can happen in the case of
simple and fast models like MLPs).</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="delu.data.IndexLoader.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/delu/data.html#IndexLoader.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.IndexLoader.__len__" title="Permalink to this definition">#</a></dt>
<dd><p>Get the size of the original DataLoader.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="delu.data.IndexLoader.loader">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loader</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><span class="pre">DataLoader</span></a></em><a class="headerlink" href="#delu.data.IndexLoader.loader" title="Permalink to this definition">#</a></dt>
<dd><p>The original DataLoader.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delu.data.make_index_dataloader">
<span class="sig-prename descclassname"><span class="pre">delu.data.</span></span><span class="sig-name descname"><span class="pre">make_index_dataloader</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><span class="pre">DataLoader</span></a></span></span><a class="reference internal" href="../_modules/delu/data.html#make_index_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.data.make_index_dataloader" title="Permalink to this definition">#</a></dt>
<dd><p>Make <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataLoader</span></code></a> over indices instead of data.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference internal" href="#delu.data.IndexDataset" title="delu.data.IndexDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.data.IndexDataset</span></code></a> and <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataLoader</span></code></a>)</p>
<p>This is just a shortcut for
<code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader(delu.data.IndexDataset(...),</span> <span class="pre">...)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> – the dataset size</p></li>
<li><p><strong>*args</strong> – positional arguments for <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a></p></li>
<li><p><strong>**kwargs</strong> – keyword arguments for <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></a></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Usage for training:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">make_index_dataloader</span><span class="p">(</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i_batch</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
        <span class="n">x_batch</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i_batch</span><span class="p">]</span>
        <span class="n">y_batch</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">i_batch</span><span class="p">]</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Other examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># len(dataset)</span>
<span class="k">for</span> <span class="n">batch_idx</span> <span class="ow">in</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">make_index_dataloader</span><span class="p">(</span>
    <span class="n">dataset_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span>
<span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch_idx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tensor([0, 1, 2])
tensor([3, 4, 5])
tensor([6, 7, 8])
tensor([9])
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># len(dataset)</span>
<span class="k">for</span> <span class="n">batch_idx</span> <span class="ow">in</span> <span class="n">delu</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">make_index_dataloader</span><span class="p">(</span>
    <span class="n">dataset_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span>
<span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch_idx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tensor([0, 1, 2])
tensor([3, 4, 5])
tensor([6, 7, 8])
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delu.hardware.free_memory">
<span class="sig-prename descclassname"><span class="pre">delu.hardware.</span></span><span class="sig-name descname"><span class="pre">free_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/delu/hardware.html#free_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.hardware.free_memory" title="Permalink to this definition">#</a></dt>
<dd><p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use <a class="reference internal" href="generated/delu.cuda.free_memory.html#delu.cuda.free_memory" title="delu.cuda.free_memory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delu.cuda.free_memory</span></code></a>.)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="delu.hardware.get_gpus_info">
<span class="sig-prename descclassname"><span class="pre">delu.hardware.</span></span><span class="sig-name descname"><span class="pre">get_gpus_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/delu/hardware.html#get_gpus_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#delu.hardware.get_gpus_info" title="Permalink to this definition">#</a></dt>
<dd><p>Get information about GPU devices: driver version, memory, utilization etc.</p>
<p>⚠️ <strong>[DEPRECATED]</strong> ⚠️ (Instead, use functions from <a class="reference external" href="https://pytorch.org/docs/stable/cuda.html#module-torch.cuda" title="(in PyTorch v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.cuda</span></code></a>)</p>
<p>The example below shows what kind of information is returned as the result. All
figures about memory are given in bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Information about GPU devices.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The ‘devices’ value contains information about <em>all</em> gpus regardless of the
value of <code class="docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code>.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">delu</span><span class="o">.</span><span class="n">hardware</span><span class="o">.</span><span class="n">get_gpu_info</span><span class="p">())</span>
</pre></div>
</div>
<p>Output example (formatted for convenience):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{
    &#39;driver&#39;: &#39;440.33.01&#39;,
    &#39;devices&#39;: [
        {
            &#39;name&#39;: &#39;GeForce RTX 2080 Ti&#39;,
            &#39;memory_total&#39;: 11554717696,
            &#39;memory_free&#39;: 11554652160,
            &#39;memory_used&#39;: 65536,
            &#39;utilization&#39;: 0,
        },
        {
            &#39;name&#39;: &#39;GeForce RTX 2080 Ti&#39;,
            &#39;memory_total&#39;: 11552096256,
            &#39;memory_free&#39;: 11552030720,
            &#39;memory_used&#39;: 65536,
            &#39;utilization&#39;: 0,
        },
    ],
}
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="generated/delu.tools.Timer.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Timer</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Yura52
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/Yura52/delu" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">[deprecated]</a><ul>
<li><a class="reference internal" href="#delu.EarlyStopping"><code class="docutils literal notranslate"><span class="pre">EarlyStopping</span></code></a><ul>
<li><a class="reference internal" href="#delu.EarlyStopping.forget_bad_updates"><code class="docutils literal notranslate"><span class="pre">EarlyStopping.forget_bad_updates()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#delu.Timer"><code class="docutils literal notranslate"><span class="pre">Timer</span></code></a><ul>
<li><a class="reference internal" href="#delu.Timer.__call__"><code class="docutils literal notranslate"><span class="pre">Timer.__call__()</span></code></a></li>
<li><a class="reference internal" href="#delu.Timer.format"><code class="docutils literal notranslate"><span class="pre">Timer.format()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#delu.ProgressTracker"><code class="docutils literal notranslate"><span class="pre">ProgressTracker</span></code></a><ul>
<li><a class="reference internal" href="#delu.ProgressTracker.__init__"><code class="docutils literal notranslate"><span class="pre">ProgressTracker.__init__()</span></code></a></li>
<li><a class="reference internal" href="#delu.ProgressTracker.best_score"><code class="docutils literal notranslate"><span class="pre">ProgressTracker.best_score</span></code></a></li>
<li><a class="reference internal" href="#delu.ProgressTracker.fail"><code class="docutils literal notranslate"><span class="pre">ProgressTracker.fail</span></code></a></li>
<li><a class="reference internal" href="#delu.ProgressTracker.forget_bad_updates"><code class="docutils literal notranslate"><span class="pre">ProgressTracker.forget_bad_updates()</span></code></a></li>
<li><a class="reference internal" href="#delu.ProgressTracker.reset"><code class="docutils literal notranslate"><span class="pre">ProgressTracker.reset()</span></code></a></li>
<li><a class="reference internal" href="#delu.ProgressTracker.success"><code class="docutils literal notranslate"><span class="pre">ProgressTracker.success</span></code></a></li>
<li><a class="reference internal" href="#delu.ProgressTracker.update"><code class="docutils literal notranslate"><span class="pre">ProgressTracker.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#delu.Stream"><code class="docutils literal notranslate"><span class="pre">Stream</span></code></a><ul>
<li><a class="reference internal" href="#delu.Stream.__init__"><code class="docutils literal notranslate"><span class="pre">Stream.__init__()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.data"><code class="docutils literal notranslate"><span class="pre">Stream.data()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.epoch"><code class="docutils literal notranslate"><span class="pre">Stream.epoch</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.epochs"><code class="docutils literal notranslate"><span class="pre">Stream.epochs()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.increment_epoch"><code class="docutils literal notranslate"><span class="pre">Stream.increment_epoch()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.iteration"><code class="docutils literal notranslate"><span class="pre">Stream.iteration</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.load_state_dict"><code class="docutils literal notranslate"><span class="pre">Stream.load_state_dict()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.loader"><code class="docutils literal notranslate"><span class="pre">Stream.loader</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.next"><code class="docutils literal notranslate"><span class="pre">Stream.next()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.reload_iterator"><code class="docutils literal notranslate"><span class="pre">Stream.reload_iterator()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.set_loader"><code class="docutils literal notranslate"><span class="pre">Stream.set_loader()</span></code></a></li>
<li><a class="reference internal" href="#delu.Stream.state_dict"><code class="docutils literal notranslate"><span class="pre">Stream.state_dict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#delu.collate"><code class="docutils literal notranslate"><span class="pre">collate()</span></code></a></li>
<li><a class="reference internal" href="#delu.concat"><code class="docutils literal notranslate"><span class="pre">concat()</span></code></a></li>
<li><a class="reference internal" href="#delu.improve_reproducibility"><code class="docutils literal notranslate"><span class="pre">improve_reproducibility()</span></code></a></li>
<li><a class="reference internal" href="#delu.evaluation"><code class="docutils literal notranslate"><span class="pre">evaluation</span></code></a></li>
<li><a class="reference internal" href="#delu.data.Enumerate"><code class="docutils literal notranslate"><span class="pre">Enumerate</span></code></a></li>
<li><a class="reference internal" href="#delu.data.IndexDataset"><code class="docutils literal notranslate"><span class="pre">IndexDataset</span></code></a></li>
<li><a class="reference internal" href="#delu.data.FnDataset"><code class="docutils literal notranslate"><span class="pre">FnDataset</span></code></a><ul>
<li><a class="reference internal" href="#delu.data.FnDataset.__getitem__"><code class="docutils literal notranslate"><span class="pre">FnDataset.__getitem__()</span></code></a></li>
<li><a class="reference internal" href="#delu.data.FnDataset.__init__"><code class="docutils literal notranslate"><span class="pre">FnDataset.__init__()</span></code></a></li>
<li><a class="reference internal" href="#delu.data.FnDataset.__len__"><code class="docutils literal notranslate"><span class="pre">FnDataset.__len__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#delu.data.IndexLoader"><code class="docutils literal notranslate"><span class="pre">IndexLoader</span></code></a><ul>
<li><a class="reference internal" href="#delu.data.IndexLoader.__init__"><code class="docutils literal notranslate"><span class="pre">IndexLoader.__init__()</span></code></a></li>
<li><a class="reference internal" href="#delu.data.IndexLoader.__len__"><code class="docutils literal notranslate"><span class="pre">IndexLoader.__len__()</span></code></a></li>
<li><a class="reference internal" href="#delu.data.IndexLoader.loader"><code class="docutils literal notranslate"><span class="pre">IndexLoader.loader</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#delu.data.make_index_dataloader"><code class="docutils literal notranslate"><span class="pre">make_index_dataloader()</span></code></a></li>
<li><a class="reference internal" href="#delu.hardware.free_memory"><code class="docutils literal notranslate"><span class="pre">free_memory()</span></code></a></li>
<li><a class="reference internal" href="#delu.hardware.get_gpus_info"><code class="docutils literal notranslate"><span class="pre">get_gpus_info()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=2ca83e85"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    </body>
</html>